<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>BF</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">
<meta content="telephone=no" name="format-detection">
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />
<meta name="full-screen" content="true">
<meta name="screen-orientation" content="portrait">
<meta name="x5-fullscreen" content="true">
<meta name="360-fullscreen" content="true">
<meta name="description" content="">
<meta name="keywords" content="">

</head>
<body>
<script type="text/javascript">
    var sourceStr = "BBCABBABCF";
    var searchStr = "ABC";
    var longSourceStr = "There are some times wThere are some times when clicking “like” on a friend’s Facebook status doesn’t feel appropriate. A bad day. A loved one lost. A break up. It only seems natural that a “dislike” button could solve the conundrum of wanting to empathize but not seem inappropriate by clicking “like.” Mark Zuckerberg Puts the Rest of Us to Shame by Speaking Fluent Chinese. Mark Zuckerberg: Facebook Founder and Animal Butcher. Mark Zuckerberg and That Shirt. The idea has been on Mark Zuckerberg’s radar for a while, he said. In 2010, he told ABC News’ Diane Sawyer that that Facebook would “definitely thinkThere are some times when clicking “like” on a friend’s Facebook status doesn’t feel appropriate. A bad day. A loved one lost. A break up. It only seems natural that a “dislike” button could solve the conundrum of wanting to empathize but not seem inappropriate by clicking “like.” Mark Zuckerberg Puts the Rest of Us to Shame by Speaking Fluent Chinese. Mark Zuckerberg: Facebook Founder and Animal Butcher. Mark Zuckerberg and That Shirt. The idea has been on Mark Zuckerberg’s radar for a while, he said. In 2010, he told ABC News’ Diane Sawyer that that Facebook would “definitely thinkThere are some times when clicking “like” on a friend’s Facebook status doesn’t feel appropriate. A bad day. A loved one lost. A break up. It only seems natural that a “dislike” button could solve the conundrum of wanting to empathize but not seem inappropriate by clicking “like.” Mark Zuckerberg Puts the Rest of Us to Shame by Speaking Fluent Chinese. Mark Zuckerberg: Facebook Founder and Animal Butcher. Mark Zuckerberg and That Shirt. The idea has been on Mark Zuckerberg’s radar for a while, he said. In 2010, he told ABC News’ Diane Sawyer that that Facebook would “definitely thinkThere are some times when clicking “like” on a friend’s Facebook status doesn’t feel appropriate. A bad day. A loved one lost. A break up. It only seems natural that a “dislike” button could solve the conundrum of wanting to empathize but not seem inappropriate by clicking “like.” Mark Zuckerberg Puts the Rest of Us to Shame by Speaking Fluent Chinese. Mark Zuckerberg: Facebook Founder and Animal Butcher. Mark Zuckerberg and That Shirt. The idea has been on Mark Zuckerberg’s radar for a while, he said. In 2010, he told ABC News’ Diane Sawyer that that Facebook would “definitely thinkThere are some times when clicking “like” on a friend’s Facebook status doesn’t feel appropriate. A bad day. A loved one lost. A break up. It only seems natural that a “dislike” button could solve the conundrum of wanting to empathize but not seem inappropriate by clicking “like.” Mark Zuckerberg Puts the Rest of Us to Shame by Speaking Fluent Chinese. Mark Zuckerberg: Facebook Founder and Animal Butcher. Mark Zuckerberg and That Shirt. The idea has been on Mark Zuckerberg’s radar for a while, he said. In 2010, he told ABC News’ Diane Sawyer that that Facebook would “definitely thinkThere are some times when clicking “like” on a friend’s Facebook status doesn’t feel appropriate. A bad day. A loved one lost. A break up. It only seems natural that a “dislike” button could solve the conundrum of wanting to empathize but not seem inappropriate by clicking “like.” Mark Zuckerberg Puts the Rest of Us to Shame by Speaking Fluent Chinese. Mark Zuckerberg: Facebook Founder and Animal Butcher. Mark Zuckerberg and That Shirt. The idea has been on Mark Zuckerberg’s radar for a while, he said. In 2010, he told ABC News’ Diane Sawyer that that Facebook would “definitely thinkhen clicking “like” on a friend’s Facebook status doesn’t feel appropriate. A bad day. A loved one lost. A break up. It only seems natural that a “dislike” button could solve the conundrum of wanting to empathize but not seem inappropriate by clicking “like.” Mark Zuckerberg Puts the Rest of Us to Shame by Speaking Fluent Chinese. Mark Zuckerberg: Facebook Founder and Animal Butcher. Mark Zuckerberg and That Shirt. The idea has been on Mark Zuckerberg’s radar for a while, he said. In 2010, he told ABC News’ Diane Sawyer There are some times when clicking “like” on a friend’s Facebook status doesn’t feel appropriate. A bad day. A loved one lost. A break up. It only seems natural that a “dislike” button could solve the conundrum of wanting to empathize but not seem inappropriate by clicking “like.” Mark Zuckerberg Puts the Rest of Us to Shame by Speaking Fluent Chinese. Mark Zuckerberg: Facebook Founder and Animal Butcher. Mark Zuckerberg and That Shirt. The idea has been on Mark Zuckerberg’s radar for a while, he said. In 2010, he told ABC News’ Diane Sawyer that that Facebook would “definitely thinkThere are some times when clicking “like” on a friend’s Facebook status doesn’t feel appropriate. A bad day. A loved one lost. A break up. It only seems natural that a “dislike” button could solve the conundrum of wanting to empathize but not seem inappropriate by clicking “like.” Mark Zuckerberg Puts the Rest of Us to Shame by Speaking Fluent Chinese. Mark Zuckerberg: Facebook Founder and Animal Butcher. Mark Zuckerberg and That Shirt. The idea has been on Mark Zuckerberg’s radar for a while, he said. In 2010, he told ABC News’ Diane Sawyer that that Facebook would “definitely thinkThere are some times when clicking “like” on a friend’s Facebook status doesn’t feel appropriate. A bad day. A loved one lost. A break up. It only seems natural that a “dislike” button could solve the conundrum of wanting to empathize but not seem inappropriate by clicking “like.” Mark Zuckerberg Puts the Rest of Us to Shame by Speaking Fluent Chinese. Mark Zuckerberg: Facebook Founder and Animal Butcher. Mark Zuckerberg and That Shirt. The idea has been on Mark Zuckerberg’s radar for a while, he said. In 2010, he told ABC News’ Diane Sawyer that that Facebook would “definitely thinkThere are some times when clicking “like” on a friend’s Facebook status doesn’t feel appropriate. A bad day. A loved one lost. A break up. It only seems natural that a “dislike” button could solve the conundrum of wanting to empathize but not seem inappropriate by clicking “like.” Mark Zuckerberg Puts the Rest of Us to Shame by Speaking Fluent Chinese. Mark Zuckerberg: Facebook Founder and Animal Butcher. Mark Zuckerberg and That Shirt. The idea has been on Mark Zuckerberg’s radar for a while, he said. In 2010, he told ABC News’ Diane Sawyer that that Facebook would “definitely think that that Facebook would “definitely think about” adding a dislike button. “People definitely seem to want it,” Zuckerberg said. Four years later — Zuckerberg says Facebook is still “thinking about” adding the oft-requested sdfafd button, Zuckerberg says Facebook is still “thinking about” adding the oft-requested button. At a town hall meeting on Thursday, the CEO revealed he has some reservations about the feature. “There are two things that it can mean,” Zuckerberg said of the potential button, which could be used in a mean spirited way or to express empathy. Finding how to limit it to the latter is the challenge. Zuckerberg said he doesn’t want the button to turn into a “voting mechanism” or something that isn’t “socially valuable.” “Often people will tell us they don’t feel comfortable pressing ‘like,'” Zuckerberg said. “What’s the right way to make it so people can easier express a wide range of emotions?” One suggestion percolating online: Aaron Roll out the feature under a different name. However, an “empathy button” just may not have the same ring to it as “dislike.”";
    var longSearchStr = "adding the oft-requested sdf";

    function getKmpMatchVal(str) {
        var prefix = [];
        var suffix = [];
        var partMatch = [];
        var len = str.length;
        var i = 0,
            matchLen = 1,
            newStr, k,
            j = 0;
        for (; i < len; i++) {
            newStr = str.slice(0, matchLen);
            k = 0;
            for (var j = 1; j < matchLen; j++) {
                if (newStr.slice(0, j) === newStr.slice(-j)) {
                    k++;
                };
            }
            matchLen++;
            partMatch[i] = k;
        }
        return partMatch;
    }

    function bfOptimize2(sourceStr, searchStr, part) {
        var i = 0,
            j = 0,
            sourceLen = sourceStr.length;
        searchLen = searchStr.length;

        while (i < sourceLen) {
            // 两字母相等则继续
            if (sourceStr.charAt(i) === searchStr.charAt(j)) {
                i++;
                j++;
            } else { // 两字母不等则角标后退重新开始匹配
                i = i - j + 1; // i 回退到上次匹配首位的下一位
                j = 0; // j回退到子串的首位
            }

            //是字符串的长度
            if (j === searchLen) {
                //匹配起始位置
                return i - j;
            }
        }
        return -1;
    }

/*function next(str) {
    var prefix = [];
    var suffix = [];
    var partMatch;
    var i = str.length
    var newStr = str.substring(0, i + 1);
    for (var k = 0; k < i; k++) {
        //取前缀
        prefix[k] = newStr.slice(0, k + 1);
        suffix[k] = newStr.slice(-k - 1);
        if (prefix[k] == suffix[k]) {
            partMatch = prefix[k].length;
        }
    }
    if (!partMatch) {
        partMatch = 0;
    }
    return partMatch;
}

function KMP(sourceStr, searchStr) {
    var sourceLength = sourceStr.length;
    var searchLength = searchStr.length;
    var result;
    var i = 0;
    var j = 0;

    for (; i < sourceStr.length; i++) { //最外层循环，主串

        //子循环
        for (var j = 0; j < searchLength; j++) {
            //如果与主串匹配
            if (searchStr.charAt(j) == sourceStr.charAt(i)) {
                //如果是匹配完成
                if (j == searchLength - 1) {
                    result = i - j;
                    break;
                } else {
                    //如果匹配到了，就继续循环，i++是用来增加主串的下标位
                    i++;
                }
            } else {
                if (j > 1) {
                    i += i - next(searchStr.slice(0, j));
                } else {
                    //移动一位
                    i = (i - j)
                }
                break;
            }
        }

        if (result || result == 0) {
            break;
        }
    }


    if (result || result == 0) {
        return result
    } else {
        return -1;
    }
}*/
    function KMP(sourceStr, searchStr) {
        //生成匹配表
        var part = getKmpMatchVal(searchStr);
        var sourceLength = sourceStr.length;
        var searchLength = searchStr.length;
        var result;
        var i = 0;
        var j = 0;

        for (; i < sourceStr.length; i++) { //最外层循环，主串
            //子循环
            for (var j = 0; j < searchLength; j++) {
                //如果与主串匹配
                if (searchStr.charAt(j) == sourceStr.charAt(i)) {
                    //如果是匹配完成
                    if (j == searchLength - 1) {
                        result = i - j;
                        break;
                    } else {
                        //如果匹配到了，就继续循环，i++是用来增加主串的下标位
                        i++;
                    }
                } else {
                    //在子串的匹配中i是被叠加了
                    if (j > 1 && part[j - 1] > 0) {
                        i += (i - j - part[j - 1]);
                    } else {
                        //移动一位
                        i = (i - j)
                    }
                    break;
                }
            }
            if (result || result == 0) {
                break;
            }
        }
        if (result || result == 0) {
            return result
        }
        return -1;

    }

    function test(fn) {
        var start = performance.now();
        console.log(fn(sourceStr, searchStr));
        console.log(fn('asddsfsf', 'fs') === 5);
        console.log(fn('asddsfsf', 'as') === 0);
        console.log(fn('123AAABBBABABAbc', 'Abc') === 13);
        console.log(fn('123AAABBBABABAbc', 'ABc') === -1);
        console.log(fn(longSourceStr, longSearchStr));
        console.log(fn.name, performance.now() - start);
    }
    // debugger
    // 测试在这种小字符串查找还不如我前面的快……毕竟每次都要getKmpMatchVal
    test(KMP)
    // test(bfOptimize1)
    // test(bfOptimize2)
</script>
</body>
</html>
